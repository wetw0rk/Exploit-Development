/* wetw0rk */

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

/*
 62 typedef struct _USER_TYPE_CONFUSION_OBJECT
 63 {
 64     ULONG_PTR ObjectID;
 65     ULONG_PTR ObjectType;
 66 } USER_TYPE_CONFUSION_OBJECT, *PUSER_TYPE_CONFUSION_OBJECT;
 67
 68 #pragma warning(push)
 69 #pragma warning(disable : 4201)
 70 typedef struct _KERNEL_TYPE_CONFUSION_OBJECT
 71 {
 72     ULONG_PTR ObjectID;
 73     union
 74     {
 75         ULONG_PTR ObjectType;
 76         FunctionPointer Callback;
 77     };
 78 } KERNEL_TYPE_CONFUSION_OBJECT, *PKERNEL_TYPE_CONFUSION_OBJECT;
 */

typedef struct _USER_TYPE_CONFUSION_OBJECT
{
  // ULONG_PTR is 32bit in size for x86 so lets force it
  uint32_t *ObjectId;
  uint32_t *ObjectType;
} USER_TYPE_CONFUSION_OBJECT;

typedef struct _KERNEL_TYPE_CONFUSION_OBJECT
{
  uint32_t *ObjectId;
  union
  {
    uint32_t *ObjectType;
    void(*func)();
  };
} KERNEL_TYPE_CONFUSION_OBJECT;

int main()
{
  printf("Sizeof USER_TYPE_CONFUSION_OBJECT   : %d\n", sizeof(USER_TYPE_CONFUSION_OBJECT));
  printf("Sizeof KERNEL_TYPE_CONFUSION_OBJECT : %d\n", sizeof(KERNEL_TYPE_CONFUSION_OBJECT));
}
